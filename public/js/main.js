$(document).ready(function(){var a=document.getElementById("canvas_coord"),e=new EasyCanvas("canvas_coord"),o=document.getElementById("canvas"),r=EasyCanvas("canvas"),c=[],n=34,t=n/2,i=$(".color_picker").val(),l=$(".pindou_shape:checked").val(),s=$(".siser_col").val(),v=$(".siser_row").val();function f(a,e){r.clean(20+n*a+1,20+n*e+1,n-2,n-2),c[a][e]=1}!function(){var r=s*n,t=v*n;a.width=r+100,a.height=t+100,o.width=r+100,o.height=t+100;for(var i=20;i<=t+20;i+=n)e.text({basic:[0,i-20,(i-20)/n],font:"14px Arial Black 500"}).line({basic:[[20,i],[r+20,i]],strokeColor:"#000"});for(var i=20;i<=r+20;i+=n)e.text({basic:[i-20,12,(i-20)/n]}).line({basic:[[i,20],[i,t+20]]});c=[];for(var l=0;l<s;l++){c[l]=[];for(var f=0;f<v;f++)c[l][f]=0}$(".color_count").html("0")}(),O("#canvas").mousedown(function(a){!function(a){var e=parseInt((a.offsetX-t)/n),o=parseInt((a.offsetY-t)/n);{if(!(e<s&&o<v))return!1;if("rectangle"==l){if(0!=c[e][o]&&1!=c[e][o])return void f(e,o);h=e,p=o,i=$(".color_picker").val(),h>=0&&h<s&&p>=0&&p<v&&(r.rect({basic:[20+n*h+2,20+n*p+2,n-4,n-4],strokeColor:"transparent",fillColor:i}),c[h][p]=i)}else{if(0!=c[e][o]&&1!=c[e][o])return void f(e,o);u=e,d=o,i=$(".color_picker").val(),u>=0&&u<s&&d>=0&&d<v&&(r.arc({basic:[20+t*(1+2*u),20+t*(1+2*d),t-4,0,2*Math.PI],strokeColor:i,fillColor:i}),c[u][d]=i)}}var u,d;var h,p}(a)}),$(".color_picker").minicolors({letterCase:"uppercase"}),$(".pindou_shape").change(function(){l=$(".pindou_shape:checked").val()}),$(".clear_canvas").click(function(){if(1!=confirm("是否确定清空？"))return!1;r.clean(0,0,a.width,a.height)})});